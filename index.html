
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwaMedia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .page { display: none; }
        .page.active { display: block; }

        .marquee { overflow: hidden; position: relative; white-space: nowrap; }
        .marquee-content { display: inline-block; animation: marquee 45s linear infinite; will-change: transform; }
        @keyframes marquee { from { transform: translateX(0%); } to { transform: translateX(-50%); } }
        .marquee-content:hover { animation-play-state: paused; }
        
        .home-tab { color: #9ca3af; }
        .home-tab:hover { color: #ef4444; }

        .marquee-vertical { overflow: hidden; position: relative; flex-grow: 1; }
        .marquee-content-vertical { display: block; position: absolute; width: 100%; animation: marquee-vertical 180s linear infinite; will-change: transform; }
        @keyframes marquee-vertical { from { transform: translateY(0); } to { transform: translateY(-50%); } }
        .marquee-vertical:hover .marquee-content-vertical { animation-play-state: paused; }
        
        /* Sidebar Styles */
        #sidebar {
            transition: transform 0.3s ease-in-out;
            transform: translateX(100%);
        }
        #sidebar.open {
            transform: translateX(0);
        }
        #sidebar-overlay {
            transition: opacity 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-black text-white font-sans">

    <!-- Sidebar -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-40 hidden"></div>
    <div id="sidebar" class="fixed top-0 right-0 h-full w-64 bg-gray-900 shadow-lg z-50 p-6">
        <button id="closeSidebar" class="absolute top-4 right-4 text-2xl text-gray-400 hover:text-white">&times;</button>
        <h2 class="text-xl font-bold text-red-500 mb-8">Menu</h2>
        <nav class="flex flex-col space-y-4">
            <a href="#" class="text-gray-300 hover:text-red-500 transition-colors"><i class="fas fa-file-shield w-6 mr-2"></i> Disclaimer</a>
            <a href="#" class="text-gray-300 hover:text-red-500 transition-colors"><i class="fas fa-question-circle w-6 mr-2"></i> Help</a>
            <a href="#" class="text-gray-300 hover:text-red-500 transition-colors"><i class="fas fa-user-secret w-6 mr-2"></i> Privacy Policy</a>
            <a href="#" class="text-gray-300 hover:text-red-500 transition-colors"><i class="fas fa-envelope w-6 mr-2"></i> Contact Us</a>
        </nav>
    </div>

    <main id="app-content" class="pb-20">
        <!-- Home Page -->
        <div id="homePage" class="page active fade-in">
             <div class="p-4">
                <div class="flex justify-between items-center mb-4">
                    <h1 class="text-3xl font-bold text-red-500">SwaMedia</h1>
                    <button id="openSidebar" class="text-2xl text-gray-400 hover:text-white">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
                 <!-- Home Tabs -->
                <div class="flex border-b border-gray-700 mb-4">
                    <button id="tvShowsTab" class="home-tab flex-1 py-2 text-lg font-semibold border-b-2 border-transparent transition">TV Shows</button>
                    <button id="moviesTab" class="home-tab flex-1 py-2 text-lg font-semibold border-b-2 border-transparent transition">Movies</button>
                </div>
            </div>

            <!-- Banner Carousel -->
            <div class="relative w-full h-48 md:h-64 rounded-lg overflow-hidden mb-8 shadow-lg shadow-red-500/20 mx-auto px-4">
                <div id="bannerCarousel" class="w-full h-full flex transition-transform duration-500 ease-in-out">
                    <!-- Banners will be injected here -->
                </div>
                <div id="bannerDots" class="absolute bottom-2 left-1/2 -translate-x-1/2 flex space-x-2">
                    <!-- Dots will be injected here -->
                </div>
            </div>
            
            <div class="px-4">
                <!-- New Releases Scroller -->
                <div class="mb-8">
                    <h2 class="text-xl font-bold mb-3">New Releases</h2>
                    <div id="newReleasesScroller" class="marquee">
                        <!-- New releases will be injected here -->
                    </div>
                </div>

                <!-- Content Carousels by Category -->
                <div id="contentCarousels" class="space-y-8">
                    <!-- Carousels will be injected here -->
                </div>
            </div>
        </div>

        <!-- Search Page -->
        <div id="searchPage" class="page fade-in p-4">
            <div class="relative mb-6">
                <input type="text" id="searchInput" class="w-full bg-gray-900 border border-gray-700 rounded-full py-3 px-6 pl-12 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Search for movies & tv shows...">
                <i class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
            </div>
            <div id="searchResults" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                <!-- Search results will be injected here -->
            </div>
             <p id="noResults" class="text-center text-gray-400 mt-8 hidden">No results found.</p>
        </div>

        <!-- Categories Page -->
        <div id="categoriesPage" class="page fade-in">
            <h2 class="text-2xl font-bold mb-4 px-4 pt-4">Categories</h2>
            <div id="categoriesNavBar" class="px-4 pb-4 border-b border-gray-800 overflow-x-auto no-scrollbar">
                <div id="categoriesNavContent" class="flex space-x-3 whitespace-nowrap">
                    <!-- Category buttons will be injected here -->
                </div>
            </div>
            <div id="categoryContentDisplay" class="p-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                <!-- Content for the selected category will be injected here -->
            </div>
        </div>

        <!-- Profile / Auth Page -->
        <div id="profilePage" class="page fade-in p-6 max-w-md mx-auto">
            <!-- Logged Out View -->
            <div id="authView">
                <div id="loginView">
                    <h2 class="text-3xl font-bold text-center mb-6">Login</h2>
                    <form id="loginForm" class="space-y-4">
                        <input type="email" id="loginEmail" class="w-full bg-gray-900 border border-gray-700 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Email" required>
                        <input type="password" id="loginPassword" class="w-full bg-gray-900 border border-gray-700 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Password" required>
                        <button type="submit" class="w-full bg-red-600 hover:bg-red-700 rounded-lg p-3 font-bold transition-colors">Login</button>
                    </form>
                    <p class="text-center mt-4 text-gray-400">Don't have an account? <a href="#" id="showRegister" class="text-red-500 hover:underline">Sign Up</a></p>
                </div>
                <div id="registerView" class="hidden">
                    <h2 class="text-3xl font-bold text-center mb-6">Sign Up</h2>
                    <form id="registerForm" class="space-y-4">
                        <input type="email" id="registerEmail" class="w-full bg-gray-900 border border-gray-700 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Email" required>
                        <input type="password" id="registerPassword" class="w-full bg-gray-900 border border-gray-700 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Password" required>
                        <button type="submit" class="w-full bg-red-600 hover:bg-red-700 rounded-lg p-3 font-bold transition-colors">Sign Up</button>
                    </form>
                    <p class="text-center mt-4 text-gray-400">Already have an account? <a href="#" id="showLogin" class="text-red-500 hover:underline">Login</a></p>
                </div>
                <p id="authError" class="text-red-500 text-center mt-4"></p>
            </div>
            <!-- Logged In View -->
            <div id="profileView" class="hidden text-center">
                 <i class="fa-solid fa-user-circle text-6xl text-red-500 mb-4"></i>
                <h2 class="text-2xl font-bold mb-2">Welcome!</h2>
                <p id="userEmail" class="text-gray-400 mb-6"></p>
                <button id="logoutButton" class="w-full bg-red-600 hover:bg-red-700 rounded-lg p-3 font-bold transition-colors">Logout</button>
            </div>
        </div>

        <!-- Movie Details Page -->
        <div id="movieDetailsPage" class="page fade-in">
             <!-- Movie Details will be injected here -->
        </div>

        <!-- TV Show Details Page -->
        <div id="tvShowDetailsPage" class="page fade-in">
             <!-- TV Show Details will be injected here -->
        </div>

        <!-- All Movies Page -->
        <div id="allMoviesPage" class="page fade-in p-4 flex flex-col h-[calc(100vh-5rem)]">
            <div class="flex items-center mb-6 flex-shrink-0">
                <button class="home-back-btn mr-4 text-xl"><i class="fas fa-arrow-left"></i></button>
                <h2 class="text-2xl font-bold">All Movies</h2>
            </div>
            <div class="marquee-vertical">
                <div id="allMoviesGridMarqueeContent" class="marquee-content-vertical">
                    <!-- All movies will be injected here -->
                </div>
            </div>
        </div>

        <!-- All TV Shows Page -->
        <div id="allTvShowsPage" class="page fade-in p-4 flex flex-col h-[calc(100vh-5rem)]">
            <div class="flex items-center mb-6 flex-shrink-0">
                <button class="home-back-btn mr-4 text-xl"><i class="fas fa-arrow-left"></i></button>
                <h2 class="text-2xl font-bold">All TV Shows</h2>
            </div>
            <div class="marquee-vertical">
                <div id="allTvShowsGridMarqueeContent" class="marquee-content-vertical">
                    <!-- All TV shows will be injected here -->
                </div>
            </div>
        </div>

    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-black/80 backdrop-blur-sm shadow-[0_-1px_10px_rgba(0,0,0,0.2)]">
        <div id="nav-bar" class="flex justify-around max-w-xl mx-auto">
            <button data-page="homePage" class="nav-btn flex-1 p-3 text-center text-red-500">
                <i class="fas fa-home text-xl"></i>
                <span class="block text-xs font-medium">Home</span>
            </button>
            <button data-page="searchPage" class="nav-btn flex-1 p-3 text-center text-gray-400">
                <i class="fas fa-search text-xl"></i>
                <span class="block text-xs font-medium">Search</span>
            </button>
            <button data-page="categoriesPage" class="nav-btn flex-1 p-3 text-center text-gray-400">
                <i class="fas fa-th-large text-xl"></i>
                <span class="block text-xs font-medium">Categories</span>
            </button>
            <button data-page="profilePage" class="nav-btn flex-1 p-3 text-center text-gray-400">
                <i class="fas fa-user text-xl"></i>
                <span class="block text-xs font-medium">Profile</span>
            </button>
        </div>
    </nav>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getDatabase, ref, onValue, get } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        
        const firebaseConfig = {
  apiKey: "AIzaSyAAWjWH55_WogACWc3vNVWrlLrwPYPfgmo",
  authDomain: "swamediaweb.firebaseapp.com",
  databaseURL: "https://swamediaweb-default-rtdb.firebaseio.com",
  projectId: "swamediaweb",
  storageBucket: "swamediaweb.firebasestorage.app",
  messagingSenderId: "70354150749",
  appId: "1:70354150749:web:046e78eb57ce1fe427f4b4"
};       
        function initializeAppAndRun() {
            try {
                const app = initializeApp(firebaseConfig);
                const db = getDatabase(app);
                const auth = getAuth(app);
                runApp(db, auth);
            } catch (error) {
                console.error("Firebase initialization failed:", error);
                document.body.innerHTML = `<div class="flex items-center justify-center h-screen bg-black text-white"><div class="text-center"><h1 class="text-2xl text-red-500">Firebase Configuration Error</h1><p class="mt-2 text-gray-400">Please check your Firebase configuration in index.html.</p><p class="mt-1 text-sm text-gray-500">${error.message}</p></div></div>`;
            }
        }
        
        function runApp(db, auth) {
            let bannerInterval;
            let allMovies = [];
            let allTvShows = [];
            let allContent = [];
            let currentUser = null;
            let navigationHistory = ['homePage'];

            const pages = document.querySelectorAll('.page');
            const navButtons = document.querySelectorAll('.nav-btn');
            const appContent = document.getElementById('app-content');
            
            // --- SIDEBAR ---
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const openSidebarBtn = document.getElementById('openSidebar');
            const closeSidebarBtn = document.getElementById('closeSidebar');

            const toggleSidebar = () => {
                sidebar.classList.toggle('open');
                sidebarOverlay.classList.toggle('hidden');
            };

            openSidebarBtn.addEventListener('click', toggleSidebar);
            closeSidebarBtn.addEventListener('click', toggleSidebar);
            sidebarOverlay.addEventListener('click', toggleSidebar);

            const showPage = (pageId) => {
                if (!pageId) return;
                pages.forEach(page => page.classList.toggle('active', page.id === pageId));
                navButtons.forEach(btn => {
                    const isHomePageRelated = ['homePage'].includes(pageId);
                    if (btn.dataset.page === 'homePage') {
                        btn.classList.toggle('text-red-500', isHomePageRelated);
                        btn.classList.toggle('text-gray-400', !isHomePageRelated);
                    } else {
                        btn.classList.toggle('text-red-500', btn.dataset.page === pageId);
                        btn.classList.toggle('text-gray-400', btn.dataset.page !== pageId);
                    }
                });
                appContent.scrollTop = 0;
            };

            const navigateTo = (pageId) => {
                const currentPageId = navigationHistory[navigationHistory.length - 1];
                if (pageId !== currentPageId) {
                    navigationHistory.push(pageId);
                }
                showPage(pageId);
            };

            const navigateBack = () => {
                if (navigationHistory.length > 1) {
                    navigationHistory.pop();
                    const previousPageId = navigationHistory[navigationHistory.length - 1];
                    showPage(previousPageId);
                } else {
                    showPage('homePage'); // Fallback to home if history is empty or has one item
                }
            };
            
            document.getElementById('nav-bar').addEventListener('click', (e) => {
                const navBtn = e.target.closest('.nav-btn');
                if (navBtn) {
                    const pageId = navBtn.dataset.page;
                    navigationHistory = [pageId]; // Reset history for main tab navigation
                    showPage(pageId);
                }
            });

            // --- AUTHENTICATION ---
            onAuthStateChanged(auth, user => {
                currentUser = user;
                const authView = document.getElementById('authView');
                const profileView = document.getElementById('profileView');
                if (user) {
                    authView.style.display = 'none';
                    profileView.style.display = 'block';
                    document.getElementById('userEmail').textContent = user.email;
                } else {
                    authView.style.display = 'block';
                    profileView.style.display = 'none';
                    document.getElementById('userEmail').textContent = '';
                }
            });

            const authError = document.getElementById('authError');
            document.getElementById('loginForm').addEventListener('submit', (e) => { e.preventDefault(); signInWithEmailAndPassword(auth, loginEmail.value, loginPassword.value).catch(error => { authError.textContent = error.message; }); });
            document.getElementById('registerForm').addEventListener('submit', (e) => { e.preventDefault(); createUserWithEmailAndPassword(auth, registerEmail.value, registerPassword.value).catch(error => { authError.textContent = error.message; }); });
            document.getElementById('logoutButton').addEventListener('click', () => signOut(auth));
            document.getElementById('showRegister').addEventListener('click', (e) => { e.preventDefault(); loginView.classList.add('hidden'); registerView.classList.remove('hidden'); });
            document.getElementById('showLogin').addEventListener('click', (e) => { e.preventDefault(); registerView.classList.add('hidden'); loginView.classList.remove('hidden'); });

            // --- UI HELPERS ---
            const createContentCard = (item, type) => `
                <div class="bg-gray-900 rounded-lg overflow-hidden transform hover:-translate-y-1 transition-transform duration-300 shadow-lg" data-id="${item.id}" data-type="${type}">
                    <img src="${item.posterUrl || 'https://picsum.photos/200/300'}" alt="${item.title}" class="aspect-[2/3] w-full object-cover cursor-pointer">
                    <div class="p-2"><h3 class="text-sm font-semibold truncate text-white">${item.title}</h3><p class="text-xs text-gray-400">${item.year || ''}</p></div>
                </div>`;

            // --- HOME PAGE & NAVIGATION TABS ---
            document.getElementById('tvShowsTab').addEventListener('click', () => showAllTvShows());
            document.getElementById('moviesTab').addEventListener('click', () => showAllMovies());

            const loadBanners = () => {
                onValue(ref(db, 'banners/'), (snapshot) => {
                    const data = snapshot.val();
                    const bannerCarousel = document.getElementById('bannerCarousel');
                    const bannerDots = document.getElementById('bannerDots');
                    if (!data || !bannerCarousel || !bannerDots) { if (bannerCarousel) b